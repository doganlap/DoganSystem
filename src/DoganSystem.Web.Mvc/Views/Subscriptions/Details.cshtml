@model DoganSystem.Modules.Subscription.Application.Dtos.SubscriptionDto
@{
    ViewData["Title"] = "Subscription Details";
}

<div class="container">
    <div class="row">
        <div class="col-md-8">
            <h2>Subscription Details</h2>
            <div class="card">
                <div class="card-body">
                    <dl class="row">
                        <dt class="col-sm-3">Tenant ID:</dt>
                        <dd class="col-sm-9">@Model.TenantId</dd>

                        <dt class="col-sm-3">Plan Type:</dt>
                        <dd class="col-sm-9">@Model.PlanType</dd>

                        <dt class="col-sm-3">Status:</dt>
                        <dd class="col-sm-9">
                            <span class="badge bg-@(Model.Status == "Active" ? "success" : "warning")">
                                @Model.Status
                            </span>
                        </dd>

                        <dt class="col-sm-3">Monthly Price:</dt>
                        <dd class="col-sm-9">@Model.MonthlyPrice.ToString("C")</dd>

                        <dt class="col-sm-3">Start Date:</dt>
                        <dd class="col-sm-9">@Model.StartDate.ToString("yyyy-MM-dd")</dd>

                        <dt class="col-sm-3">End Date:</dt>
                        <dd class="col-sm-9">@(Model.EndDate?.ToString("yyyy-MM-dd") ?? "N/A")</dd>

                        <dt class="col-sm-3">Next Billing:</dt>
                        <dd class="col-sm-9">@(Model.NextBillingDate?.ToString("yyyy-MM-dd") ?? "N/A")</dd>

                        <dt class="col-sm-3">Payment Provider:</dt>
                        <dd class="col-sm-9">@(Model.PaymentProvider ?? "N/A")</dd>
                    </dl>

                    <div class="mt-3">
                        @if (Model.Status == "Active")
                        {
                            <button class="btn btn-warning" onclick="cancelSubscription('@Model.Id')">Cancel Subscription</button>
                        }
                        else
                        {
                            <button class="btn btn-success" onclick="renewSubscription('@Model.Id')">Renew Subscription</button>
                        }
                        <a href="/Subscriptions" class="btn btn-secondary">Back to List</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        async function cancelSubscription(id) {
            if (confirm('Are you sure you want to cancel this subscription?')) {
                await fetch(`/api/subscriptions/${id}/cancel`, { method: 'POST' });
                location.reload();
            }
        }

        async function renewSubscription(id) {
            await fetch(`/api/subscriptions/${id}/renew`, { method: 'POST' });
            location.reload();
        }
    </script>
}
